"use strict";(self.webpackChunkpharmacy_frontend=self.webpackChunkpharmacy_frontend||[]).push([[4816],{8845:function(e,n,t){t.d(n,{Z:function(){return s}});var a=t(885),i=t(2791),r=t(9126),o={card:"card-info_card__VcLb9",header:"card-info_header__uTcny",warning:"card-info_warning__bmiK1"},l=t(3329);var s=function(e){var n=e.headerTitle,t=e.children,s=e.type,c=(0,i.useState)(!0),d=(0,a.Z)(c,2),u=d[0],h=d[1];return(0,l.jsxs)("div",{className:[o.card,"warning"===s?o.warning:null].join(" "),children:[(0,l.jsxs)("div",{onClick:function(){return h(!u)},className:[o.header,"warning"===s?o.warning:null].join(" "),children:[(0,l.jsx)("p",{children:n}),(0,l.jsx)("label",{className:o.header_label,onClick:function(){return h(!u)},children:u?(0,l.jsx)(r.jnn,{}):(0,l.jsx)(r.F0C,{})})]}),u&&(0,l.jsx)("div",{children:t})]})}},4293:function(e,n,t){t.d(n,{Z:function(){return N}});var a=t(4942),i=t(1413),r=t(2982),o=t(885),l=t(2791),s=t(3168),c=t(2810),d=t(6030),u=t(6154),h=t(8489),f=t(7425),m=t(6856),p=t(9942),v="multi-value_container__efvXg",x="multi-value_row__CgABK",j="multi-value_header__sV-dg",g="multi-value_input_div__4ZhqR",_=t(3585),b=t(3329);var Z=function(e){var n=e.addHandler,t=e.deleteHandler,a=e.values,i=e.changeHandler,r=e.placeholder,o=e.quantityLabel,l=e.bonusLabel,c=e.afterQuantityLabel,d=e.afterBonusLabel,u=e.allowEdit,h=(0,s.$)().t;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:j,children:u&&(0,b.jsxs)("div",{className:[p.Z.icon,p.Z.fc_green,p.Z.margin_h_auto].join(" "),children:[(0,b.jsx)(m.NcC,{size:36,onClick:function(e){n(),e.stopPropagation()}}),(0,b.jsx)("div",{className:p.Z.tooltip,children:h("add-offer-tooltip")})]})}),(0,b.jsx)("div",{className:v,children:a.map((function(e){return(0,b.jsxs)("div",{className:x,children:[(0,b.jsxs)("div",{className:g,children:[o&&(0,b.jsx)("label",{children:o}),(0,b.jsx)("input",{id:e.key,title:"qty",value:e.value.qty,onChange:function(e){return i(e)},placeholder:r,onKeyPress:_.I0,disabled:!u}),c&&(0,b.jsx)("label",{children:c})]}),(0,b.jsxs)("div",{className:g,children:[l&&(0,b.jsx)("label",{children:l}),(0,b.jsx)("input",{id:e.key,title:"bonus",value:e.value.bonus,onChange:function(e){return i(e)},placeholder:r,disabled:!u}),d&&(0,b.jsx)("label",{children:d})]},e.key),u&&(0,b.jsxs)("div",{className:[p.Z.icon,p.Z.fc_red].join(" "),children:[(0,b.jsx)(f.w6k,{size:20,onClick:function(){return t(e.key)}}),(0,b.jsx)("div",{className:p.Z.tooltip,children:h("remove-offer-tooltip")})]})]},e.key)}))})]})},y="offers-modal_checkboxes_div__jHFjO",w="offers-modal_offer_type_checkbox__6qdXR",C=t(8785);var N=function(e){var n,t=e.item,f=e.warehouseId,v=e.close,x=e.token,j=e.allowEdit,g=e.afterUpdateOffer,N=(0,s.$)().t,k=(0,d.I0)(),E=t.warehouses.find((function(e){return e.warehouse._id===f})).offer,S=(0,l.useState)(!1),L=(0,o.Z)(S,2),O=L[0],I=L[1],R=(0,l.useState)(E.mode===_.Hg.PIECES),A=(0,o.Z)(R,2),q=A[0],H=A[1],T=(0,l.useState)(E.mode===_.Hg.PERCENTAGE),D=(0,o.Z)(T,2),W=D[0],F=D[1],U=(0,l.useState)((null===(n=E.offers)||void 0===n?void 0:n.length)>0?E.offers.map((function(e){return{value:{qty:e.qty,bonus:e.bonus},key:e._id}})):[]),M=(0,o.Z)(U,2),P=M[0],z=M[1];return(0,b.jsxs)(h.Z,{header:"nav-offers",cancelLabel:"close-label",okLabel:"add-label",closeModal:v,okModal:j?function(){!function(){if(q||W){var e=P.filter((function(e){return 0!==e.value.bonus||e.value.qty})).sort((function(e,n){return e.value.qty>n.value.qty?-1:e.value.qty<n.value.qty?1:0})).map((function(e){return{qty:e.value.qty,bonus:e.value.bonus}})),n={mode:0===e.length?"":q?_.Hg.PIECES:_.Hg.PERCENTAGE,offers:e};k((0,u.Ex)({obj:{itemId:t._id,warehouseId:f,offer:n},token:x})).then(C.SI).then((function(){return g&&g()})),v()}else I(!0)}()}:null,small:!0,children:[j&&P.length>0&&(0,b.jsxs)("div",{className:y,children:[(0,b.jsxs)("label",{children:[N("offer-type"),":"]}),(0,b.jsxs)("div",{className:w,children:[(0,b.jsx)("input",{type:"checkbox",value:q,checked:q,onChange:function(){H(!q),F(!1),I(!1)}}),(0,b.jsx)("label",{children:N(_.Hg.PIECES)})]}),(0,b.jsxs)("div",{className:w,children:[(0,b.jsx)("input",{type:"checkbox",value:W,checked:W,onChange:function(){F(!W),H(!1),I(!1)}}),(0,b.jsx)("label",{children:N(_.Hg.PERCENTAGE)})]}),O&&(0,b.jsx)(m.wr$,{color:_.wL.FAILED_COLOR,size:24})]}),0===P.length&&(0,b.jsx)("p",{className:[p.Z.center,p.Z.fc_secondary].join(" "),children:N("no-offers")}),(0,b.jsx)(Z,{allowEdit:j,values:P,addHandler:function(){return z([].concat((0,r.Z)(P),[{value:{qty:0,bonus:0},key:(0,c.Z)()}]))},deleteHandler:function(e){var n=P.filter((function(n){return n.key!==e}));z(n)},changeHandler:function(e){var n=P.map((function(n){return n.key===e.target.id?(0,i.Z)((0,i.Z)({},n),{},{value:(0,i.Z)((0,i.Z)({},n.value),{},(0,a.Z)({},e.target.title,1*(0,_.F8)(e.target.value)))}):n}));z(n)},quantityLabel:N("quantity-label"),bonusLabel:q?N("bonus-quantity-label"):W?N("bonus-percentage-label"):null,afterQuantityLabel:N("after-quantity-label"),afterBonusLabel:q?N("after-bonus-quantity-label"):W?N("after-bonus-percentage-label"):null})]})}},4816:function(e,n,t){t.r(n),t.d(n,{default:function(){return U}});var a=t(4942),i=t(1413),r=t(885),o=t(2791),l=t(3168),s=t(9271),c=t(4569),d=t.n(c),u=t(1221),h=t(8785),f=t(6030),m=t(3541),p=t(3268),v=t(6523),x=t(6425),j=t(8845),g=t(9724),_=t(9488),b=t(1847),Z=t(4293),y=t(9942),w=t(3329);var C=t(1176),N=t(2541),k=t(7500),E=t(1061),S=t(8489),L=t(8370),O=t(3585),I=t(6856),R=t(7425),A="item-page_content__R9NDn",q="item-page_textarea__qwkQA",H="item-page_horizontal_div__uGnXE",T="item-page_error_ul__SKblv",D="item-page_info__3cySs",W="item-page_logo__l6dvL",F=t(4131);var U=function(){var e,n,t,c,U,M,P,z,V,B,G=(0,l.$)().t,$=(0,f.I0)(),K=(0,s.k6)(),X=(0,s.TH)().state,Y=X.from,Q=X.allowAction,J=X.type,ee=X.itemId,ne=X.companyId,te=X.warehouseId,ae=o.useRef(null),ie=(0,f.v9)(x.VY),re=(0,f.v9)(m.tT),oe=re.user,le=re.token,se=(0,f.v9)(p.a1),ce=se.addStatus,de=se.updateStatus,ue=se.changeLogoStatus,he=(0,f.v9)(v.oH),fe=he.addToWarehouseStatus,me=he.removeFromWarehouseStatus,pe=(0,o.useState)(!1),ve=(0,r.Z)(pe,2),xe=ve[0],je=ve[1],ge=(0,o.useState)(!1),_e=(0,r.Z)(ge,2),be=_e[0],Ze=_e[1],ye=(0,o.useState)(""),we=(0,r.Z)(ye,2),Ce=we[0],Ne=we[1],ke=(0,o.useState)(!1),Ee=(0,r.Z)(ke,2),Se=Ee[0],Le=Ee[1],Oe=(0,o.useState)(!1),Ie=(0,r.Z)(Oe,2),Re=Ie[0],Ae=Ie[1],qe=(0,o.useState)("idle"),He=(0,r.Z)(qe,2),Te=He[0],De=He[1],We=(0,o.useState)({}),Fe=(0,r.Z)(We,2),Ue=Fe[0],Me=Fe[1],Pe=(0,o.useState)(""),ze=(0,r.Z)(Pe,2),Ve=ze[0],Be=ze[1],Ge=(0,o.useState)({name:"",caliber:"",formula:"",indication:"",barcode:"",composition:"",packing:"",price:0,customer_price:0}),$e=(0,r.Z)(Ge,2),Ke=$e[0],Xe=$e[1],Ye=function(e){Xe((0,i.Z)((0,i.Z)({},Ke),{},(0,a.Z)({},e.target.id,"price"===e.target.id||"customer_price"===e.target.id?(0,O.F8)(e.target.value):e.target.value))),Me((0,i.Z)((0,i.Z)({},Ue),{},(0,a.Z)({},e.target.id,"")))},Qe=(0,o.useCallback)((function(){De("loading"),d().get("".concat(O.Hc,"/items/item/").concat(ee),{headers:{Authorization:"Bearer ".concat(le)}}).then((function(e){Xe(e.data.data.item),De("idle")})).catch((function(e){De("idle")}))}));return(0,o.useEffect)((function(){"info"===J&&ee&&(Qe(),window.scrollTo(0,0))}),[ee,J]),oe?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(E.Z,{children:[(0,w.jsx)("h2",{children:Ke.name}),(0,w.jsx)("div",{className:y.Z.refresh_icon,children:(0,w.jsx)(k.Z,{selected:!1,foreColor:O.wL.WHITE_COLOR,tooltip:G("refresh-tooltip"),icon:function(){return(0,w.jsx)(R.PwW,{})},onclick:function(){"info"===J&&ee&&(Qe(),window.scrollTo(0,0))}})})]}),(0,w.jsx)("div",{className:y.Z.container_with_header,children:(0,w.jsxs)("div",{className:A,children:[(0,w.jsxs)("div",{className:[y.Z.flex_center_container,y.Z.flex_column,y.Z.padding_v_6,y.Z.padding_h_12].join(" "),children:["succeeded"===ue||"idle"===ue?(0,w.jsx)("div",{className:W,children:(0,w.jsx)("img",{src:Ke.logo_url&&""!==Ke.logo_url?"".concat(O.LB,"/items/").concat(Ke.logo_url):u,alt:"thumb"})}):null,Q&&ee&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:{display:"none"},children:(0,w.jsx)("form",{encType:"multipart/form-data",children:(0,w.jsx)("div",{children:(0,w.jsx)("input",{type:"file",name:"file",onChange:function(e){if(e.target.files[0])if(parseFloat(e.target.files[0].size/1024).toFixed(2)<512){var n=new FormData;n.append("file",e.target.files[0]);var t={headers:{"content-type":"multipart/form-data",Authorization:"Bearer ".concat(le)}};d().post("".concat(O.Hc,"/items/upload/").concat(Ke._id),n,t).then((function(e){Qe()}))}else Be("image-size-must-be-less-than")},ref:ae,stye:{display:"none"}})})})}),(0,w.jsx)("div",{children:(0,w.jsx)("button",{className:[y.Z.button,y.Z.bg_secondary,y.Z.fc_white,y.Z.padding_h_12,y.Z.padding_v_6].join(" "),onClick:function(){ae.current.click()},children:G("change-logo")})})]}),Q&&(Y===O.Wl.COMPANY||Y===O.Wl.ADMIN)&&(0,w.jsx)("div",{className:y.Z.margin_v_4,children:(0,w.jsx)(C.Z,{text:G("info"===J?"update-item":"add-item"),bgColor:O.wL.SUCCEEDED_COLOR,action:function(){return Ae(!0)}})}),oe.type===O.Wl.PHARMACY&&(null===(e=Ke.warehouses)||void 0===e?void 0:e.length)>0&&(0,w.jsx)("div",{className:y.Z.margin_v_4,children:(0,w.jsx)(C.Z,{text:G("add-to-cart"),action:function(){return je(!0)},bgColor:O.wL.SUCCEEDED_COLOR})}),oe.type===O.Wl.WAREHOUSE&&(null!==(n=Ke.warehouses)&&void 0!==n&&n.map((function(e){return e.warehouse._id})).includes(oe._id)?(0,w.jsx)("div",{className:y.Z.margin_v_4,children:(0,w.jsx)(C.Z,{text:G("remove-from-warehouse"),action:function(){ie?$((0,v.LK)({obj:{itemId:ee,warehouseId:te},token:le})).then(h.SI).then((function(){return Qe()})).catch((function(){})):$((0,x.Rb)())},bgColor:O.wL.FAILED_COLOR})}):(0,w.jsx)("div",{className:y.Z.margin_v_4,children:(0,w.jsx)(C.Z,{text:G("add-to-warehouse"),action:function(){ie?$((0,v._h)({obj:{itemId:ee,warehouseId:te},token:le})).then(h.SI).then((function(){return Qe()})).catch((function(){})):$((0,x.Rb)())},bgColor:O.wL.SUCCEEDED_COLOR})}))]}),(0,w.jsxs)("div",{className:D,children:[(0,w.jsxs)(j.Z,{headerTitle:G("item-main-info"),children:[(0,w.jsx)(g.Z,{label:"item-trade-name",id:"name",type:"text",value:Ke.name,bordered:!1,icon:(0,L.q)("medicine"),onchange:Ye,error:(null===(t=Ue.name)||void 0===t?void 0:t.length)>0,readOnly:!Q}),(0,w.jsx)("div",{className:H}),(0,w.jsx)(g.Z,{label:"item-formula",id:"formula",type:"text",value:Ke.formula,bordered:!1,icon:(0,L.q)("medicine"),onchange:Ye,error:(null===(c=Ue.formula)||void 0===c?void 0:c.length)>0,readOnly:!Q}),(0,w.jsx)("div",{className:H}),(0,w.jsx)(g.Z,{label:"item-caliber",id:"caliber",type:"text",value:Ke.caliber,bordered:!1,icon:(0,L.q)("medicine"),onchange:Ye,error:(null===(U=Ue.caliber)||void 0===U?void 0:U.length)>0,readOnly:!Q}),(0,w.jsx)("div",{className:H}),(0,w.jsx)(g.Z,{label:"item-packing",id:"packing",type:"text",value:Ke.packing,bordered:!1,icon:(0,L.q)("medicine"),onchange:Ye,error:(null===(M=Ue.packing)||void 0===M?void 0:M.length)>0,readOnly:!Q}),(0,w.jsx)("div",{className:H}),(0,w.jsx)(g.Z,{label:"item-barcode",id:"barcode",type:"text",value:Ke.barcode,bordered:!1,icon:(0,L.q)("medicine"),onchange:Ye,readOnly:!Q})]}),(0,w.jsxs)(j.Z,{headerTitle:G("item-price"),children:[oe.type!==O.Wl.GUEST&&(0,w.jsx)("div",{style:{width:"300px"},children:(0,w.jsx)(g.Z,{label:"item-price",id:"price",type:"number",value:Ke.price,bordered:!1,icon:(0,L.q)("price"),onchange:Ye,error:(null===(P=Ue.price)||void 0===P?void 0:P.length)>0,readOnly:!Q})}),(0,w.jsx)("div",{className:H}),(0,w.jsx)("div",{style:{width:"300px"},children:(0,w.jsx)(g.Z,{label:"item-customer-price",id:"customer_price",type:"number",value:Ke.customer_price,bordered:!1,icon:(0,L.q)("price"),onchange:Ye,error:(null===(z=Ue.customer_price)||void 0===z?void 0:z.length)>0,readOnly:!Q})})]}),(0,w.jsx)(j.Z,{headerTitle:G("item-composition"),children:(0,w.jsx)("div",{children:(0,w.jsx)("textarea",{className:q,placeholder:G("enter-composition"),id:"composition",value:Ke.composition,onChange:Ye,disabled:!Q})})}),(0,w.jsx)(j.Z,{headerTitle:G("item-indication"),children:(0,w.jsx)("div",{children:(0,w.jsx)("textarea",{className:q,placeholder:G("enter-indication"),id:"indication",value:Ke.indication,onChange:Ye,disabled:!Q})})}),(null===(V=Ke.warehouses)||void 0===V?void 0:V.length)>0&&oe.type===O.Wl.ADMIN&&(0,w.jsx)(j.Z,{headerTitle:G("warehouses"),children:Ke.warehouses.map((function(e,n){return(0,w.jsxs)("div",{className:[F.Z.container,F.Z.without_box_shadow,y.Z.padding_h_6].join(" "),children:[(0,w.jsx)("label",{className:y.Z.padding_v_6,children:e.warehouse.name}),(0,w.jsxs)("div",{className:y.Z.icon,onClick:function(){Ne(e.warehouse._id),Le(oe.type===O.Wl.WAREHOUSE&&oe._id===e.warehouse._id||oe.type===O.Wl.ADMIN&&e.warehouse.allowAdmin),Ze(!0)},children:[(0,w.jsx)(I.Rtn,{}),(0,w.jsx)("div",{className:y.Z.tooltip,children:G("nav-offers")})]})]},n)}))}),(null===(B=Ke.warehouses)||void 0===B?void 0:B.length)>0&&oe.type===O.Wl.PHARMACY&&(0,w.jsx)(j.Z,{headerTitle:G("warehouses"),children:Ke.warehouses.filter((function(e){return e.warehouse.city===oe.city})).map((function(e,n){return(0,w.jsxs)("div",{className:[F.Z.container,F.Z.without_box_shadow,y.Z.padding_h_6].join(" "),children:[(0,w.jsx)("label",{className:y.Z.padding_v_6,children:e.warehouse.name}),(0,w.jsxs)("div",{className:y.Z.icon,onClick:function(){Ne(e.warehouse._id),Le(oe.type===O.Wl.WAREHOUSE&&oe._id===e.warehouse._id||oe.type===O.Wl.ADMIN&&e.warehouse.allowAdmin),Ze(!0)},children:[(0,w.jsx)(I.Rtn,{}),(0,w.jsx)("div",{className:y.Z.tooltip,children:G("nav-offers")})]})]},n)}))}),Object.entries(Ue).length>0&&(0,w.jsx)("ul",{className:T,children:Object.keys(Ue).map((function(e){return Ue[e].length>0?(0,w.jsx)("li",{children:G(Ue[e])},e):null}))})]})]})}),"loading"===ue&&(0,w.jsx)(N.Z,{allowCancel:!1}),"loading"===fe&&(0,w.jsx)(N.Z,{allowCancel:!1}),"loading"===me&&(0,w.jsx)(N.Z,{allowCancel:!1}),("loading"===de||"loading"===Te)&&(0,w.jsx)(N.Z,{allowCancel:!1}),"succeeded"===ce&&(0,w.jsx)(_.Z,{bgColor:O.wL.SUCCEEDED_COLOR,foreColor:"#fff",actionAfterTimeout:function(){$((0,p.s4)())},children:(0,w.jsx)("p",{children:G("add-item-succeeded")})}),"succeeded"===de&&(0,w.jsx)(_.Z,{bgColor:O.wL.SUCCEEDED_COLOR,foreColor:"#fff",actionAfterTimeout:function(){$((0,p.uM)())},children:(0,w.jsx)("p",{children:G("update-item-succeeded")})}),Ve&&(0,w.jsx)(_.Z,{bgColor:O.wL.FAILED_COLOR,foreColor:"#fff",actionAfterTimeout:function(){Be("")},children:(0,w.jsx)("p",{children:G("image-size-must-be-less-than")})}),xe&&(0,w.jsx)(b.Z,{item:Ke,close:function(){return je(!1)}}),be&&(0,w.jsx)(Z.Z,{token:le,item:Ke,warehouseId:Ce,allowEdit:Se,close:function(){Ze(!1),Ne(""),Le(!1)},afterUpdateOffer:Qe}),Re&&(0,w.jsx)(S.Z,{header:"info"===J?"update-item":"add-item",cancelLabel:"cancel-label",okLabel:"ok-label",closeModal:function(){Ae(!1)},small:!0,okModal:function(){var e={};if(0===Ke.name.length&&(e.name="enter-item-trade-name"),0!==Ke.price&&Ke.price||(e.price="enter-price"),0!==Ke.customer_price&&Ke.customer_price||(e.customer_price="enter-customer-price"),0===Object.entries(e).length){if(!ie)return void $((0,x.Rb)());var n=(0,i.Z)({},Ke);"new"===J?(n=(0,i.Z)((0,i.Z)({},n),{},{company:ne}),$((0,p.jX)({obj:n,token:le})).then(h.SI).then((function(e){K.push({pathname:"/item",state:{from:Y,type:"info",allowAction:Q,itemId:e.data.item._id,companyId:ne,warehouseId:te}})})).catch((function(){}))):"info"===J&&(n=(0,i.Z)((0,i.Z)({},n),{},{_id:ee}),$((0,p.$G)({obj:n,token:le})).then((function(){Ae(!1)})).catch((function(){Ae(!1)})))}else Me((0,i.Z)({},e)),Ae(!1)},children:"info"===J?(0,w.jsx)("p",{children:G("update-item-confirm-msg")}):(0,w.jsx)("p",{children:G("add-item-confirm-msg")})})]}):(0,w.jsx)(s.l_,{to:"/signin"})}},2810:function(e,n,t){var a;t.d(n,{Z:function(){return u}});var i=new Uint8Array(16);function r(){if(!a&&!(a="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var l=function(e){return"string"===typeof e&&o.test(e)},s=[],c=0;c<256;++c)s.push((c+256).toString(16).substr(1));var d=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(s[e[n+0]]+s[e[n+1]]+s[e[n+2]]+s[e[n+3]]+"-"+s[e[n+4]]+s[e[n+5]]+"-"+s[e[n+6]]+s[e[n+7]]+"-"+s[e[n+8]]+s[e[n+9]]+"-"+s[e[n+10]]+s[e[n+11]]+s[e[n+12]]+s[e[n+13]]+s[e[n+14]]+s[e[n+15]]).toLowerCase();if(!l(t))throw TypeError("Stringified UUID is invalid");return t};var u=function(e,n,t){var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n){t=t||0;for(var i=0;i<16;++i)n[t+i]=a[i];return n}return d(a)}}}]);
//# sourceMappingURL=4816.07f1ccbc.chunk.js.map