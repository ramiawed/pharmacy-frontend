"use strict";(self.webpackChunkpharmacy_frontend=self.webpackChunkpharmacy_frontend||[]).push([[89],{8845:function(e,n,t){t.d(n,{Z:function(){return c}});var a=t(885),i=t(2791),r=t(9126),o={card:"card-info_card__VcLb9",header:"card-info_header__uTcny",warning:"card-info_warning__bmiK1"},l=t(3329);var c=function(e){var n=e.headerTitle,t=e.children,c=e.type,s=(0,i.useState)(!0),d=(0,a.Z)(s,2),u=d[0],h=d[1];return(0,l.jsxs)("div",{className:[o.card,"warning"===c?o.warning:null].join(" "),children:[(0,l.jsxs)("div",{onClick:function(){return h(!u)},className:[o.header,"warning"===c?o.warning:null].join(" "),children:[(0,l.jsx)("p",{children:n}),(0,l.jsx)("label",{className:o.header_label,onClick:function(){return h(!u)},children:u?(0,l.jsx)(r.jnn,{}):(0,l.jsx)(r.F0C,{})})]}),u&&(0,l.jsx)("div",{children:t})]})}},8865:function(e,n,t){var a=t(8785),i=t(2791),r=t(3168),o=t(6030),l=t(3541),c=t(3268),s=t(9942),d=t(3329);n.Z=function(e){var n=e.type,t=e.item,u=e.readOnly,h=e.onchange,f=(0,r.$)().t,m=(0,o.I0)(),p=i.useRef(null),v=(0,o.v9)(l.tT),x=v.token,j=v.user;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{children:(0,d.jsx)("button",{className:[s.Z.button,s.Z.bg_secondary,s.Z.fc_white,s.Z.padding_h_12,s.Z.padding_v_6].join(" "),onClick:function(){p.current.click()},disabled:u,children:f("change-logo")})}),(0,d.jsx)("input",{multiple:!1,accept:"image/*",ref:p,type:"file",onChange:function(e){var i=e.target.files[0];if(i){var r=new FormData;if("partner"===n?r.append("name","".concat(j.username).concat(Date.now(),".").concat(i.name.split(".").pop())):r.append("name","".concat(t.name.replace("%","")).concat(Date.now(),".").concat(i.name.split(".").pop())),r.append("file",i),"partner"===n)m((0,l.kG)({data:r,token:x})).then(a.SI).then((function(){h&&h()}));else{var o=t._id;m((0,c.kR)({data:r,_id:o,token:x})).then(a.SI).then((function(){h&&h()}))}}},style:{display:"none"}})]})}},4293:function(e,n,t){t.d(n,{Z:function(){return k}});var a=t(4942),i=t(1413),r=t(2982),o=t(885),l=t(2791),c=t(3168),s=t(2810),d=t(6030),u=t(6154),h=t(8489),f=t(7425),m=t(6856),p=t(9942),v="multi-value_container__efvXg",x="multi-value_row__CgABK",j="multi-value_header__sV-dg",g="multi-value_input_div__4ZhqR",_=t(3585),b=t(3329);var Z=function(e){var n=e.addHandler,t=e.deleteHandler,a=e.values,i=e.changeHandler,r=e.placeholder,o=e.quantityLabel,l=e.bonusLabel,s=e.afterQuantityLabel,d=e.afterBonusLabel,u=e.allowEdit,h=(0,c.$)().t;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:j,children:u&&(0,b.jsxs)("div",{className:[p.Z.icon,p.Z.fc_green,p.Z.margin_h_auto].join(" "),children:[(0,b.jsx)(m.NcC,{size:36,onClick:n}),(0,b.jsx)("div",{className:p.Z.tooltip,children:h("add-offer-tooltip")})]})}),(0,b.jsx)("div",{className:v,children:a.map((function(e){return(0,b.jsxs)("div",{className:x,children:[(0,b.jsxs)("div",{className:g,children:[o&&(0,b.jsx)("label",{children:o}),(0,b.jsx)("input",{id:e.key,title:"qty",value:e.value.qty,onChange:function(e){return i(e)},placeholder:r,onKeyPress:_.I0,disabled:!u}),s&&(0,b.jsx)("label",{children:s})]}),(0,b.jsxs)("div",{className:g,children:[l&&(0,b.jsx)("label",{children:l}),(0,b.jsx)("input",{id:e.key,title:"bonus",value:e.value.bonus,onChange:function(e){return i(e)},placeholder:r,disabled:!u}),d&&(0,b.jsx)("label",{children:d})]},e.key),u&&(0,b.jsxs)("div",{className:[p.Z.icon,p.Z.fc_red].join(" "),children:[(0,b.jsx)(f.w6k,{size:20,onClick:function(){return t(e.key)}}),(0,b.jsx)("div",{className:p.Z.tooltip,children:h("remove-offer-tooltip")})]})]},e.key)}))})]})},y="offers-modal_checkboxes_div__jHFjO",w="offers-modal_offer_type_checkbox__6qdXR",C=t(8785);var k=function(e){var n,t=e.item,f=e.warehouseId,v=e.close,x=e.token,j=e.allowEdit,g=e.afterUpdateOffer,k=(0,c.$)().t,N=(0,d.I0)(),E=t.warehouses.find((function(e){return e.warehouse._id===f})).offer,S=(0,l.useState)(!1),L=(0,o.Z)(S,2),O=L[0],I=L[1],R=(0,l.useState)(E.mode===_.Hg.PIECES),q=(0,o.Z)(R,2),A=q[0],D=q[1],H=(0,l.useState)(E.mode===_.Hg.PERCENTAGE),T=(0,o.Z)(H,2),W=T[0],U=T[1],M=(0,l.useState)((null===(n=E.offers)||void 0===n?void 0:n.length)>0?E.offers.map((function(e){return{value:{qty:e.qty,bonus:e.bonus},key:e._id}})):[]),F=(0,o.Z)(M,2),P=F[0],V=F[1];return(0,b.jsxs)(h.Z,{header:"nav-offers",cancelLabel:"close-label",okLabel:"add-label",closeModal:v,okModal:j?function(){!function(){if(A||W){var e=P.filter((function(e){return 0!==e.value.bonus||e.value.qty})).sort((function(e,n){return e.value.qty>n.value.qty?-1:e.value.qty<n.value.qty?1:0})).map((function(e){return{qty:e.value.qty,bonus:e.value.bonus}})),n={mode:0===e.length?"":A?_.Hg.PIECES:_.Hg.PERCENTAGE,offers:e};N((0,u.Ex)({obj:{itemId:t._id,warehouseId:f,offer:n},token:x})).then(C.SI).then((function(){return g&&g()})),v()}else I(!0)}()}:null,small:!0,children:[j&&P.length>0&&(0,b.jsxs)("div",{className:y,children:[(0,b.jsxs)("label",{children:[k("offer-type"),":"]}),(0,b.jsxs)("div",{className:w,children:[(0,b.jsx)("input",{type:"checkbox",value:A,checked:A,onChange:function(){D(!A),U(!1),I(!1)}}),(0,b.jsx)("label",{children:k(_.Hg.PIECES)})]}),(0,b.jsxs)("div",{className:w,children:[(0,b.jsx)("input",{type:"checkbox",value:W,checked:W,onChange:function(){U(!W),D(!1),I(!1)}}),(0,b.jsx)("label",{children:k(_.Hg.PERCENTAGE)})]}),O&&(0,b.jsx)(m.wr$,{color:_.wL.FAILED_COLOR,size:24})]}),0===P.length&&(0,b.jsx)("p",{className:[p.Z.center,p.Z.fc_secondary].join(" "),children:k("no-offers")}),(0,b.jsx)(Z,{allowEdit:j,values:P,addHandler:function(){return V([].concat((0,r.Z)(P),[{value:{qty:0,bonus:0},key:(0,s.Z)()}]))},deleteHandler:function(e){var n=P.filter((function(n){return n.key!==e}));V(n)},changeHandler:function(e){var n=P.map((function(n){return n.key===e.target.id?(0,i.Z)((0,i.Z)({},n),{},{value:(0,i.Z)((0,i.Z)({},n.value),{},(0,a.Z)({},e.target.title,1*(0,_.F8)(e.target.value)))}):n}));V(n)},quantityLabel:k("quantity-label"),bonusLabel:A?k("bonus-quantity-label"):W?k("bonus-percentage-label"):null,afterQuantityLabel:k("after-quantity-label"),afterBonusLabel:A?k("after-bonus-quantity-label"):W?k("after-bonus-percentage-label"):null})]})}},1089:function(e,n,t){t.r(n),t.d(n,{default:function(){return M}});var a=t(4942),i=t(1413),r=t(885),o=t(2791),l=t(3168),c=t(9271),s=t(4569),d=t.n(s),u=t(8785),h=t(6030),f=t(3541),m=t(3268),p=t(6523),v=t(6425),x=t(8845),j=t(9724),g=t(9488),_=t(1847),b=t(4293),Z=t(8865),y=t(1176),w=t(2541),C=t(7500),k=t(1061),N=t(8489),E=t(8370),S=t(3585),L=t(6856),O=t(7425),I=t(9942),R="item-page_content__R9NDn",q="item-page_textarea__qwkQA",A="item-page_horizontal_div__uGnXE",D="item-page_error_ul__SKblv",H="item-page_info__3cySs",T="item-page_logo__l6dvL",W=t(4131),U=(t(5619),t(3329));var M=function(){var e,n,t,s,M,F,P,V,G,$,B=(0,l.$)().t,z=(0,h.I0)(),K=(0,c.k6)(),Y=(0,c.TH)().state,X=Y.from,Q=Y.allowAction,J=Y.type,ee=Y.itemId,ne=Y.companyId,te=Y.warehouseId,ae=(0,h.v9)(v.VY),ie=(0,h.v9)(f.tT),re=ie.user,oe=ie.token,le=(0,h.v9)(m.a1),ce=le.addStatus,se=le.updateStatus,de=le.changeLogoStatus,ue=(0,h.v9)(p.oH),he=ue.addToWarehouseStatus,fe=ue.removeFromWarehouseStatus,me=(0,o.useState)(!1),pe=(0,r.Z)(me,2),ve=pe[0],xe=pe[1],je=(0,o.useState)(!1),ge=(0,r.Z)(je,2),_e=ge[0],be=ge[1],Ze=(0,o.useState)(""),ye=(0,r.Z)(Ze,2),we=ye[0],Ce=ye[1],ke=(0,o.useState)(!1),Ne=(0,r.Z)(ke,2),Ee=Ne[0],Se=Ne[1],Le=(0,o.useState)(!1),Oe=(0,r.Z)(Le,2),Ie=Oe[0],Re=Oe[1],qe=(0,o.useState)("idle"),Ae=(0,r.Z)(qe,2),De=Ae[0],He=Ae[1],Te=(0,o.useState)({}),We=(0,r.Z)(Te,2),Ue=We[0],Me=We[1],Fe=(0,o.useState)({name:"",caliber:"",formula:"",indication:"",barcode:"",composition:"",packing:"",price:0,customer_price:0}),Pe=(0,r.Z)(Fe,2),Ve=Pe[0],Ge=Pe[1],$e=function(e){Ge((0,i.Z)((0,i.Z)({},Ve),{},(0,a.Z)({},e.target.id,"price"===e.target.id||"customer_price"===e.target.id?(0,S.F8)(e.target.value):e.target.value))),Me((0,i.Z)((0,i.Z)({},Ue),{},(0,a.Z)({},e.target.id,"")))},Be=(0,o.useCallback)((function(){He("loading"),d().get("".concat(S.Hc,"/items/item/").concat(ee),{headers:{Authorization:"Bearer ".concat(oe)}}).then((function(e){Ge(e.data.data.item),He("idle")})).catch((function(e){He("idle")}))}));return(0,o.useEffect)((function(){"info"===J&&ee&&(Be(),window.scrollTo(0,0))}),[ee,J]),re?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)("div",{className:I.Z.container,children:[(0,U.jsxs)(k.Z,{children:[(0,U.jsx)("h2",{children:Ve.name}),(0,U.jsx)("div",{style:{position:"absolute",top:"16px",left:"46px"},children:(0,U.jsx)(C.Z,{selected:!1,foreColor:S.wL.SECONDARY_COLOR,tooltip:B("refresh-tooltip"),icon:function(){return(0,U.jsx)(O.PwW,{})},onclick:function(){"info"===J&&ee&&(Be(),window.scrollTo(0,0))}})})]}),(0,U.jsxs)("div",{className:R,children:[(0,U.jsxs)("div",{className:[I.Z.flex_center_container,I.Z.flex_column,I.Z.padding_v_6,I.Z.padding_h_12].join(" "),children:["succeeded"===de||"idle"===de?(0,U.jsx)("div",{className:T,children:(0,U.jsx)("img",{src:Ve.logo_url&&""!==Ve.logo_url?"".concat(S.LB,"/").concat(Ve.logo_url):"".concat(S.LB,"/medicine.jpeg"),alt:"thumb"})}):null,Q&&ee&&(0,U.jsx)("div",{children:(0,U.jsx)(Z.Z,{type:"item",item:Ve,onchange:function(){Be()}})}),Q&&(X===S.Wl.COMPANY||X===S.Wl.ADMIN)&&(0,U.jsx)("div",{className:I.Z.margin_v_4,children:(0,U.jsx)(y.Z,{text:B("info"===J?"update-item":"add-item"),bgColor:S.wL.SUCCEEDED_COLOR,action:function(){return Re(!0)}})}),re.type===S.Wl.PHARMACY&&(null===(e=Ve.warehouses)||void 0===e?void 0:e.length)>0&&(0,U.jsx)("div",{className:I.Z.margin_v_4,children:(0,U.jsx)(y.Z,{text:B("add-to-cart"),action:function(){return xe(!0)},bgColor:S.wL.SUCCEEDED_COLOR})}),re.type===S.Wl.WAREHOUSE&&(null!==(n=Ve.warehouses)&&void 0!==n&&n.map((function(e){return e.warehouse._id})).includes(re._id)?(0,U.jsx)("div",{className:I.Z.margin_v_4,children:(0,U.jsx)(y.Z,{text:B("remove-from-warehouse"),action:function(){ae?z((0,p.LK)({obj:{itemId:ee,warehouseId:te},token:oe})).then(u.SI).then((function(){return Be()})).catch((function(){})):z((0,v.Rb)())},bgColor:S.wL.FAILED_COLOR})}):(0,U.jsx)("div",{className:I.Z.margin_v_4,children:(0,U.jsx)(y.Z,{text:B("add-to-warehouse"),action:function(){ae?z((0,p._h)({obj:{itemId:ee,warehouseId:te},token:oe})).then(u.SI).then((function(){return Be()})).catch((function(){})):z((0,v.Rb)())},bgColor:S.wL.SUCCEEDED_COLOR})}))]}),(0,U.jsxs)("div",{className:H,children:[(0,U.jsxs)(x.Z,{headerTitle:B("item-main-info"),children:[(0,U.jsx)(j.Z,{label:"item-trade-name",id:"name",type:"text",value:Ve.name,bordered:!1,icon:(0,E.q)("medicine"),onchange:$e,error:(null===(t=Ue.name)||void 0===t?void 0:t.length)>0,readOnly:!Q}),(0,U.jsx)("div",{className:A}),(0,U.jsx)(j.Z,{label:"item-formula",id:"formula",type:"text",value:Ve.formula,bordered:!1,icon:(0,E.q)("medicine"),onchange:$e,error:(null===(s=Ue.formula)||void 0===s?void 0:s.length)>0,readOnly:!Q}),(0,U.jsx)("div",{className:A}),(0,U.jsx)(j.Z,{label:"item-caliber",id:"caliber",type:"text",value:Ve.caliber,bordered:!1,icon:(0,E.q)("medicine"),onchange:$e,error:(null===(M=Ue.caliber)||void 0===M?void 0:M.length)>0,readOnly:!Q}),(0,U.jsx)("div",{className:A}),(0,U.jsx)(j.Z,{label:"item-packing",id:"packing",type:"text",value:Ve.packing,bordered:!1,icon:(0,E.q)("medicine"),onchange:$e,error:(null===(F=Ue.packing)||void 0===F?void 0:F.length)>0,readOnly:!Q}),(0,U.jsx)("div",{className:A}),(0,U.jsx)(j.Z,{label:"item-barcode",id:"barcode",type:"text",value:Ve.barcode,bordered:!1,icon:(0,E.q)("medicine"),onchange:$e,readOnly:!Q})]}),(0,U.jsxs)(x.Z,{headerTitle:B("item-price"),children:[re.type!==S.Wl.GUEST&&(0,U.jsx)("div",{style:{width:"300px"},children:(0,U.jsx)(j.Z,{label:"item-price",id:"price",type:"number",value:Ve.price,bordered:!1,icon:(0,E.q)("price"),onchange:$e,error:(null===(P=Ue.price)||void 0===P?void 0:P.length)>0,readOnly:!Q})}),(0,U.jsx)("div",{className:A}),(0,U.jsx)("div",{style:{width:"300px"},children:(0,U.jsx)(j.Z,{label:"item-customer-price",id:"customer_price",type:"number",value:Ve.customer_price,bordered:!1,icon:(0,E.q)("price"),onchange:$e,error:(null===(V=Ue.customer_price)||void 0===V?void 0:V.length)>0,readOnly:!Q})})]}),(0,U.jsx)(x.Z,{headerTitle:B("item-composition"),children:(0,U.jsx)("div",{children:(0,U.jsx)("textarea",{className:q,placeholder:B("enter-composition"),id:"composition",value:Ve.composition,onChange:$e,disabled:!Q})})}),(0,U.jsx)(x.Z,{headerTitle:B("item-indication"),children:(0,U.jsx)("div",{children:(0,U.jsx)("textarea",{className:q,placeholder:B("enter-indication"),id:"indication",value:Ve.indication,onChange:$e,disabled:!Q})})}),(null===(G=Ve.warehouses)||void 0===G?void 0:G.length)>0&&re.type===S.Wl.ADMIN&&(0,U.jsx)(x.Z,{headerTitle:B("warehouses"),children:Ve.warehouses.map((function(e,n){return(0,U.jsxs)("div",{className:[W.Z.container,W.Z.without_box_shadow,I.Z.padding_h_6].join(" "),children:[(0,U.jsx)("label",{className:I.Z.padding_v_6,children:e.warehouse.name}),(0,U.jsxs)("div",{className:I.Z.icon,onClick:function(){Ce(e.warehouse._id),Se(re.type===S.Wl.WAREHOUSE&&re._id===e.warehouse._id||re.type===S.Wl.ADMIN&&e.warehouse.allowAdmin),be(!0)},children:[(0,U.jsx)(L.Rtn,{}),(0,U.jsx)("div",{className:I.Z.tooltip,children:B("nav-offers")})]})]},n)}))}),(null===($=Ve.warehouses)||void 0===$?void 0:$.length)>0&&re.type===S.Wl.PHARMACY&&(0,U.jsx)(x.Z,{headerTitle:B("warehouses"),children:Ve.warehouses.filter((function(e){return e.warehouse.city===re.city})).map((function(e,n){return(0,U.jsxs)("div",{className:[W.Z.container,W.Z.without_box_shadow,I.Z.padding_h_6].join(" "),children:[(0,U.jsx)("label",{className:I.Z.padding_v_6,children:e.warehouse.name}),(0,U.jsxs)("div",{className:I.Z.icon,onClick:function(){Ce(e.warehouse._id),Se(re.type===S.Wl.WAREHOUSE&&re._id===e.warehouse._id||re.type===S.Wl.ADMIN&&e.warehouse.allowAdmin),be(!0)},children:[(0,U.jsx)(L.Rtn,{}),(0,U.jsx)("div",{className:I.Z.tooltip,children:B("nav-offers")})]})]},n)}))}),Object.entries(Ue).length>0&&(0,U.jsx)("ul",{className:D,children:Object.keys(Ue).map((function(e){return Ue[e].length>0?(0,U.jsx)("li",{children:B(Ue[e])},e):null}))})]})]})]}),"loading"===de&&(0,U.jsx)(w.Z,{allowCancel:!1}),"loading"===he&&(0,U.jsx)(w.Z,{allowCancel:!1}),"loading"===fe&&(0,U.jsx)(w.Z,{allowCancel:!1}),("loading"===se||"loading"===De)&&(0,U.jsx)(w.Z,{allowCancel:!1}),"succeeded"===ce&&(0,U.jsx)(g.Z,{bgColor:S.wL.SUCCEEDED_COLOR,foreColor:"#fff",actionAfterTimeout:function(){z((0,m.s4)())},children:(0,U.jsx)("p",{children:B("add-item-succeeded")})}),"succeeded"===se&&(0,U.jsx)(g.Z,{bgColor:S.wL.SUCCEEDED_COLOR,foreColor:"#fff",actionAfterTimeout:function(){z((0,m.uM)())},children:(0,U.jsx)("p",{children:B("update-item-succeeded")})}),ve&&(0,U.jsx)(_.Z,{item:Ve,close:function(){return xe(!1)}}),_e&&(0,U.jsx)(b.Z,{token:oe,item:Ve,warehouseId:we,allowEdit:Ee,close:function(){be(!1),Ce(""),Se(!1)},afterUpdateOffer:Be}),Ie&&(0,U.jsx)(N.Z,{header:"info"===J?"update-item":"add-item",cancelLabel:"cancel-label",okLabel:"ok-label",closeModal:function(){Re(!1)},small:!0,okModal:function(){var e={};if(0===Ve.name.length&&(e.name="enter-item-trade-name"),0!==Ve.price&&Ve.price||(e.price="enter-price"),0!==Ve.customer_price&&Ve.customer_price||(e.customer_price="enter-customer-price"),0===Object.entries(e).length){if(!ae)return void z((0,v.Rb)());var n=(0,i.Z)({},Ve);"new"===J?(n=(0,i.Z)((0,i.Z)({},n),{},{company:ne}),z((0,m.jX)({obj:n,token:oe})).then(u.SI).then((function(e){K.push({pathname:"/item",state:{from:X,type:"info",allowAction:Q,itemId:e.data.item._id,companyId:ne,warehouseId:te}})})).catch((function(){}))):"info"===J&&(n=(0,i.Z)((0,i.Z)({},n),{},{_id:ee}),z((0,m.$G)({obj:n,token:oe})).then((function(){Re(!1)})).catch((function(){Re(!1)})))}else Me((0,i.Z)({},e)),Re(!1)},children:"info"===J?(0,U.jsx)("p",{children:B("update-item-confirm-msg")}):(0,U.jsx)("p",{children:B("add-item-confirm-msg")})})]}):(0,U.jsx)(c.l_,{to:"/signin"})}},2810:function(e,n,t){var a;t.d(n,{Z:function(){return u}});var i=new Uint8Array(16);function r(){if(!a&&!(a="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var l=function(e){return"string"===typeof e&&o.test(e)},c=[],s=0;s<256;++s)c.push((s+256).toString(16).substr(1));var d=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(c[e[n+0]]+c[e[n+1]]+c[e[n+2]]+c[e[n+3]]+"-"+c[e[n+4]]+c[e[n+5]]+"-"+c[e[n+6]]+c[e[n+7]]+"-"+c[e[n+8]]+c[e[n+9]]+"-"+c[e[n+10]]+c[e[n+11]]+c[e[n+12]]+c[e[n+13]]+c[e[n+14]]+c[e[n+15]]).toLowerCase();if(!l(t))throw TypeError("Stringified UUID is invalid");return t};var u=function(e,n,t){var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n){t=t||0;for(var i=0;i<16;++i)n[t+i]=a[i];return n}return d(a)}}}]);
//# sourceMappingURL=89.a45f9ea3.chunk.js.map