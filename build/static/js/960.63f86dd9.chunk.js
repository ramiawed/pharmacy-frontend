"use strict";(self.webpackChunkpharmacy_frontend=self.webpackChunkpharmacy_frontend||[]).push([[960],{9960:function(e,l,a){a.r(l),a.d(l,{default:function(){return $}});var n=a(4942),i=a(7762),s=a(1413),c=a(885),t=a(2791),r=a(3168),o=a(9271),d=a(8484),m=a(978),u=a(3585),h=a(7500),x="input-file_actions__5QgxV",p=a(3329);var j=function(e){var l=e.fileChangedHandler,a=e.small,n=e.label,i=(0,r.$)().t,s=t.useRef(null),c=function(e){s.current.click()};return(0,p.jsxs)(p.Fragment,{children:[a?(0,p.jsx)(h.Z,{selected:!1,foreColor:u.wL.SUCCEEDED_COLOR,tooltip:i("items-from-excel"),onclick:c,icon:function(){return(0,p.jsx)(m.bBH,{size:24})},withBackground:!0}):(0,p.jsxs)("div",{className:x,style:{marginBlockEnd:"10px"},children:[(0,p.jsx)("label",{style:{color:u.wL.SECONDARY_COLOR},children:i(n)}),(0,p.jsx)(h.Z,{selected:!1,foreColor:u.wL.SUCCEEDED_COLOR,tooltip:i(n),onclick:c,icon:function(){return(0,p.jsx)(m.bBH,{size:24})},withBackground:!0})]}),(0,p.jsx)("input",{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",ref:s,type:"file",onChange:function(e){var a=e.target.files[0];l(a)},style:{display:"none"}})]})},f=a(8820),Z=a(9942),b=a(3559),_=a(4131);var g=function(e){var l=e.item,a=e.index,n=e.onchange,i=e.onDelete,s=e.onSelectedChanged,c=e.withUpdate,t=(0,r.$)().t,o=""===l.name||1*l.price===0||1*l.customer_price===0||!0===c&&null===l._id;return(0,p.jsxs)("div",{className:[_.Z.container,o?_.Z.error:""].join(" "),children:[(0,p.jsx)("div",{className:[b.Z.label_xsmall,Z.Z.flex_center_container].join(" "),children:(0,p.jsx)("input",{type:"checkbox",value:l.selected,checked:l.selected,onChange:function(){return s(a)}})}),(0,p.jsx)("div",{className:b.Z.label_medium,children:(0,p.jsx)("input",{className:_.Z.input,id:"name",type:"text",value:l.name,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("div",{className:b.Z.label_medium,children:(0,p.jsx)("input",{className:_.Z.input,id:"formula",type:"text",value:l.formula,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("div",{className:b.Z.label_small,children:(0,p.jsx)("input",{className:_.Z.input,id:"caliber",type:"text",value:l.caliber,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("div",{className:b.Z.label_small,children:(0,p.jsx)("input",{className:_.Z.input,id:"packing",type:"text",value:l.packing,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("div",{className:b.Z.label_medium,children:(0,p.jsx)("input",{className:_.Z.input,id:"price",onKeyPress:u.I0,value:l.price,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("div",{className:b.Z.label_medium,children:(0,p.jsx)("input",{className:_.Z.input,id:"customer_price",onKeyPress:u.I0,value:l.customer_price,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("div",{className:b.Z.label_medium,children:(0,p.jsx)("input",{className:_.Z.input,id:"barcode",type:"text",value:l.barcode,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("div",{className:b.Z.label_large,children:(0,p.jsx)("input",{className:_.Z.input,id:"indication",style:{overflow:"none",fontSize:"0.7rem"},value:l.indication,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("div",{className:b.Z.label_large,children:(0,p.jsx)("input",{className:_.Z.input,id:"composition",style:{overflow:"none",fontSize:"0.7rem"},value:l.composition,onChange:function(e){return n(e,a)}})}),(0,p.jsx)("label",{className:b.Z.label_xsmall,children:(0,p.jsxs)("div",{className:[Z.Z.icon,Z.Z.fc_red,Z.Z.margin_h_auto].join(" "),onClick:function(){return i()},children:[(0,p.jsx)(f.YK6,{size:16}),(0,p.jsx)("p",{className:Z.Z.tooltip,children:t("delete-row")})]})})]})},v=a(8489),N=a(9488),C=a(6856),S=a(3004);var y=function(e){var l=e.deleteAllItem,a=e.selectValue,n=e.itemsSelectionChange,i=(0,r.$)().t;return(0,p.jsxs)(S.Z,{children:[(0,p.jsx)("label",{className:b.Z.label_xsmall,children:(0,p.jsxs)("div",{onClick:n,children:["all"===a&&(0,p.jsx)(C.wBz,{size:20,color:u.wL.WHITE_COLOR}),"none"===a&&(0,p.jsx)(C.FlD,{size:20}),"some"===a&&(0,p.jsx)(C.Tgt,{size:20})]})}),(0,p.jsx)("label",{className:b.Z.label_medium,children:i("item-trade-name")}),(0,p.jsx)("label",{className:b.Z.label_medium,children:i("item-formula")}),(0,p.jsx)("label",{className:b.Z.label_small,children:i("item-caliber")}),(0,p.jsx)("label",{className:b.Z.label_small,children:i("item-packing")}),(0,p.jsx)("label",{className:b.Z.label_medium,children:i("item-price")}),(0,p.jsx)("label",{className:b.Z.label_medium,children:i("item-customer-price")}),(0,p.jsx)("label",{className:b.Z.label_medium,children:i("item-barcode")}),(0,p.jsx)("label",{className:b.Z.label_large,children:i("item-indication")}),(0,p.jsx)("label",{className:b.Z.label_large,children:i("item-composition")}),(0,p.jsx)("label",{className:b.Z.label_xsmall,children:(0,p.jsxs)("div",{className:[Z.Z.icon,Z.Z.fc_red,Z.Z.margin_h_auto].join(" "),onClick:l,children:[(0,p.jsx)(f.YK6,{size:16}),(0,p.jsx)("div",{className:Z.Z.tooltip,children:i("delete-all-rows")})]})})]})},w=a(1061),k=a(2541);var L=function(e){var l=e.action,a=(0,r.$)().t;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("p",{style:{color:u.wL.FAILED_COLOR,fontWeight:"bold",fontSize:"1.2rem"},children:a("excel-file-should-contains-this-columns")}),(0,p.jsxs)(S.Z,{children:["update"===l&&(0,p.jsx)("label",{className:b.Z.label_medium,children:"_id"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"name"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"formula"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"caliber"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"packing"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"price"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"customer_price"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"barcode"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"indication"}),(0,p.jsx)("label",{className:b.Z.label_medium,children:"composition"})]}),(0,p.jsx)("p",{children:a("excel-file-warning")}),(0,p.jsx)("p",{style:{color:u.wL.SUCCEEDED_COLOR,fontSize:"1.2rem"},children:a("required-criteria")}),(0,p.jsxs)("ul",{style:{marginInlineStart:"30px"},children:["update"===l&&(0,p.jsx)("li",{children:a("required-id-criteria")}),(0,p.jsx)("li",{children:a("required-name-criteria")}),(0,p.jsx)("li",{children:a("required-price-criteria")}),(0,p.jsx)("li",{children:a("required-customer-price-criteria")})]})]})},O=a(7425),E=a(8785),D=a(6030),R=a(3541),z=a(3268),A=a(6425),B="item-excel-page_actions__0hGGY",I="item-excel-page_basic_details_container__Qs+hZ",F="item-excel-page_row__GuyAC",H="item-excel-page_label__0X+D2",U="item-excel-page_name__HUPoG",Y="item-excel-page_separator__o1Wco";var $=function(){var e=(0,D.v9)(R.dy),l=(0,o.TH)(),a=(l.state?l.state:{}).companyId,m=void 0===a?0:a,x=(0,r.$)().t,f=(0,D.I0)(),b=(0,D.v9)(R.rK),_=(0,D.v9)(z.a1),S=_.addError,$=_.addStatus,q=(0,D.v9)(A.VY),K=(0,t.useState)(!1),T=(0,c.Z)(K,2),G=T[0],P=T[1],V=(0,t.useState)(!1),M=(0,c.Z)(V,2),W=M[0],Q=M[1],X=(0,t.useState)(!1),J=(0,c.Z)(X,2),ee=J[0],le=J[1],ae=(0,t.useState)(""),ne=(0,c.Z)(ae,2),ie=ne[0],se=ne[1],ce=(0,t.useState)([]),te=(0,c.Z)(ce,2),re=te[0],oe=te[1],de=(0,t.useState)(!1),me=(0,c.Z)(de,2),ue=me[0],he=me[1],xe=(0,t.useState)(""),pe=(0,c.Z)(xe,2),je=pe[0],fe=pe[1],Ze=(0,t.useState)(""),be=(0,c.Z)(Ze,2),_e=be[0],ge=be[1],ve=(0,t.useState)("all"),Ne=(0,c.Z)(ve,2),Ce=Ne[0],Se=Ne[1],ye=(0,t.useState)(0),we=(0,c.Z)(ye,2),ke=we[0],Le=we[1],Oe=(0,t.useState)(0),Ee=(0,c.Z)(Oe,2),De=Ee[0],Re=Ee[1],ze=(0,t.useState)(0),Ae=(0,c.Z)(ze,2),Be=Ae[0],Ie=Ae[1],Fe=function(){for(var e=0,l=0,a=0,n=0;n<re.length;n++)re[n].selected&&(a+=1),re[n].name&&re[n].price&&1*re[n].price!==0&&re[n].customer_price&&1*re[n].customer_price!==0&&(!G||re[n]._id)?e+=1:l+=1;Le(e),Re(l),Ie(a)},He=function(e){if(e){he(!0);var l=new FileReader,a=!!l.readAsBinaryString;l.onload=function(l){var n=l.target.result,i=d.read(n,{type:a?"binary":"array"}),c=i.SheetNames[0],t=i.Sheets[c],r=d.utils.sheet_to_json(t).map((function(e){var l=(0,s.Z)((0,s.Z)({},e),{},{_id:e._id?e._id:null,selected:!0,company:m,isActive:!0});return e.name||(l=(0,s.Z)((0,s.Z)({},l),{},{name:"",selected:!1})),e.price||(l=(0,s.Z)((0,s.Z)({},l),{},{price:0,selected:!1})),e.customer_price||(l=(0,s.Z)((0,s.Z)({},l),{},{customer_price:0,selected:!1})),e.caliber||(l=(0,s.Z)((0,s.Z)({},l),{},{caliber:""})),e.packing||(l=(0,s.Z)((0,s.Z)({},l),{},{packing:""})),e.composition||(l=(0,s.Z)((0,s.Z)({},l),{},{composition:""})),e.barcode||(l=(0,s.Z)((0,s.Z)({},l),{},{barcode:""})),e.indication||(l=(0,s.Z)((0,s.Z)({},l),{},{indication:""})),l}));oe(r),se(e.name.split(".")[0])},a?l.readAsBinaryString(e):l.readAsArrayBuffer(e),he(!1),Fe()}},Ue=function(e,l){var a=re.map((function(a,i){if(l===i){var c,t=a.selected;return a.selected&&(t=""===a.name||1*a.price===0||1*a.customer_price===0),(0,s.Z)((0,s.Z)({},a),{},(c={},(0,n.Z)(c,e.target.id,"price"===e.target.id||"customer_price"===e.target.id?(0,u.F8)(e.target.value):e.target.value),(0,n.Z)(c,"selected",t),c))}return(0,s.Z)({},a)}));oe(a),$e(a),Fe()},Ye=function(e){var l=re.map((function(l,a){return e===a?(0,s.Z)((0,s.Z)({},l),{},{selected:!l.selected}):(0,s.Z)({},l)}));oe(l),$e(l),Fe()},$e=function(e){var l=0;e.forEach((function(e){!0===e.selected&&l++})),l===e.length?Se("all"):Se(0===l?"none":"some"),Fe()};return(0,t.useEffect)((function(){Fe()}),[re]),e&&0!==m?(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:Z.Z.container,children:[(0,p.jsx)(w.Z,{children:(0,p.jsxs)("h2",{children:[0===re.length?x("add-or-update-items"):x(G?"update-items":"add-items")," "]})}),(0,p.jsx)("div",{className:B,children:re.length>0?(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:I,children:[(0,p.jsxs)("div",{className:F,children:[(0,p.jsxs)("label",{className:H,children:[x("file-name"),": "]}),(0,p.jsx)("label",{className:U,children:ie})]}),(0,p.jsxs)("div",{className:F,children:[(0,p.jsxs)("label",{className:H,children:[x("items-count"),":"]}),(0,p.jsx)("label",{className:U,children:re.length})]}),(0,p.jsxs)("div",{className:F,children:[(0,p.jsxs)("label",{className:H,children:[x("correct-items-count"),":"]}),(0,p.jsx)("label",{className:U,children:ke})]}),(0,p.jsxs)("div",{className:F,children:[(0,p.jsxs)("label",{className:H,children:[x("wrong-items-count"),":"]}),(0,p.jsx)("label",{className:U,children:De})]}),(0,p.jsxs)("div",{className:F,children:[(0,p.jsxs)("label",{className:H,children:[x("selected-items-count"),":"]}),(0,p.jsx)("label",{className:U,children:Be})]}),(0,p.jsxs)("div",{className:B,children:[G?(0,p.jsx)(h.Z,{selected:!1,foreColor:u.wL.SECONDARY_COLOR,tooltip:x("update-items"),onclick:function(){le(!0)},icon:function(){return(0,p.jsx)(C.rnx,{size:24})},withBackground:!0}):(0,p.jsx)(h.Z,{selected:!1,foreColor:u.wL.SECONDARY_COLOR,tooltip:x("add-items"),onclick:function(){le(!0)},icon:function(){return(0,p.jsx)(O.a8N,{size:20})},withBackground:!0}),(0,p.jsx)(j,{small:!0,fileChangedHandler:He})]})]})}):null}),ue&&(0,p.jsx)(k.Z,{allowCancel:!1}),0===re.length&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(j,{fileChangedHandler:function(e){P(!1),He(e)},label:"choose-file-to-add-items",action:!1}),(0,p.jsx)(L,{action:"add"}),(0,p.jsx)("div",{className:Y}),(0,p.jsx)(j,{fileChangedHandler:function(e){P(!0),He(e)},label:"choose-file-to-update-items",action:!0}),(0,p.jsx)(L,{action:"update"})]}),re.length>0?(0,p.jsx)(y,{deleteAllItem:function(){return oe([])},selectValue:Ce,itemsSelectionChange:function(){if("all"===Ce){Se("none");var e=re.map((function(e){return(0,s.Z)((0,s.Z)({},e),{},{selected:!1})}));oe(e)}if("none"===Ce||"some"===Ce){Se("all");var l=re.map((function(e){return(0,s.Z)((0,s.Z)({},e),{},{selected:!0})}));oe(l),$e(l)}Fe()}}):null,re.length>0&&re.map((function(e,l){return(0,p.jsx)(g,{onDelete:function(){return function(e){var l=re.filter((function(l,a){return e!==a}));oe(l),Fe()}(l)},onchange:Ue,onSelectedChanged:Ye,item:e,index:l,withUpdate:G},l)})),W&&(0,p.jsxs)(v.Z,{header:"add-items",cancelLabel:"close-label",closeModal:function(){return Q(!1)},small:!0,children:[(0,p.jsx)("p",{children:je}),(0,p.jsx)("p",{children:_e})]}),ee&&(0,p.jsx)(v.Z,{header:"add-items",cancelLabel:"cancel-label",okLabel:"ok-label",okModal:function(){return function(){if(le(!1),q){var e,l=[],a=[],n=[],s=(0,i.Z)(re);try{for(s.s();!(e=s.n()).done;){var c=e.value;c.selected?c.name&&c.price&&c.customer_price&&(!G||c._id)?l.push(c):a.push(c):n.push(c)}}catch(t){s.e(t)}finally{s.f()}l.length>0&&f((0,z.$)({obj:l,token:b,withUpdate:G?"addUpdate":"add"})).then(E.SI).then((function(){fe("".concat(x("inserted-items"),": ").concat(l.length)),ge("".concat(x("wrong-items"),": ").concat(a.length)),Q(!0),oe([].concat(a,n)),$e([].concat(a,n)),f((0,z.PU)())})).catch((function(){}))}else f((0,A.Rb)())}()},closeModal:function(){return le(!1)},small:!0,children:G?(0,p.jsx)("p",{children:x("insert-update-items-msg")}):(0,p.jsx)("p",{children:x("insert-items-msg")})}),"loading"===$&&(0,p.jsx)(k.Z,{allowCancel:!1}),S&&(0,p.jsx)(N.Z,{bgColor:u.wL.FAILED_COLOR,foreColor:"#fff",toastText:x(S),actionAfterTimeout:function(){f((0,z.s4)())}})]})}):(0,p.jsx)(o.l_,{to:"/signin"})}}}]);
//# sourceMappingURL=960.63f86dd9.chunk.js.map