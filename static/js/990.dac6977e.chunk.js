"use strict";(self.webpackChunkpharmacy_frontend=self.webpackChunkpharmacy_frontend||[]).push([[990],{3990:function(e,r,n){n.r(r),n.d(r,{default:function(){return E}});var t=n(2791),a=n(9271),c=n(3168),o=n(6030),s=n(3541),i=n(3107),u=n(1061),l=n(2982),m=n(885),h=n(4569),d=n.n(h),f=n(6425),p=n(3994),b=n(1886),w=n(1176),y=n(2888),j=n(8489),v=n(2541),x="cart-warehouse_header__XorCl",_="cart-warehouse_total_price__XfuYf",g=n(3585),Z=n(6481),k=n(3666),C=n(3329);var N=function(e){var r=e.warehouse,n=(0,c.$)().t,a=(0,o.I0)(),u=(0,o.v9)(f.VY),h=(0,o.v9)(s.tT),N=h.token,q=h.user,T=(0,o.v9)(i.D1),E=(0,o.v9)(Z.vi).settings.saveOrders,L=(0,t.useState)(!1),P=(0,m.Z)(L,2),S=P[0],M=P[1],R=(0,t.useState)(!1),A=(0,m.Z)(R,2),D=A[0],F=A[1],H=(0,t.useState)(!1),I=(0,m.Z)(H,2),O=I[0],Y=I[1],X=(0,t.useState)(!1),$=(0,m.Z)(X,2),z=$[0],B=$[1],G=function(){var e=0;return T.filter((function(e){return e.warehouse.warehouse.name===r})).forEach((function(r){e=e+r.qty*r.item.price-(r.bonus&&r.bonusType===g.Hg.PERCENTAGE?r.qty*r.item.price*r.bonus/100:0)})),e};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("h4",{className:x,children:r}),(0,C.jsx)(y.Z,{}),T.filter((function(e){return e.warehouse.warehouse.name===r})).map((function(e,r){return(0,C.jsx)(b.Z,{cartItem:e},r)})),(0,C.jsxs)("p",{className:_,children:[n("total-invoice-price")," ",G()]}),(0,C.jsx)(w.Z,{text:n("send-order"),bgColor:g.wL.SUCCEEDED_COLOR,action:function(){return B(!0)}}),O&&(0,C.jsx)(v.Z,{allowCancel:!1}),S&&(0,C.jsx)(j.Z,{closeModal:function(){M(!1),a((0,i.C3)(r))},header:n("send-order"),cancelLabel:n("cancel-label"),small:!0,green:!0,children:n("send-order-succeeded")}),D&&(0,C.jsx)(j.Z,{closeModal:function(){F(!1)},header:n("send-order"),cancelLabel:n("cancel-label"),small:!0,children:n("send-order-failed")}),z&&(0,C.jsx)(j.Z,{closeModal:function(){B(!1)},header:n("send-order"),cancelLabel:n("cancel-label"),okLabel:n("send-order"),okModal:function(){if(u){Y(!0);var e=T.filter((function(e){return e.warehouse.warehouse.name===r})).map((function(e){return{itemName:e.item.name,companyName:e.item.company.name,warehouseName:e.warehouse.warehouse.name,formula:e.item.formula,caliber:e.item.caliber,packing:e.item.packing,price:e.item.price,customerPrice:e.item.customer_price,quantity:e.qty,bonus:e.bonusType?"".concat(e.bonus," ").concat("pieces"===e.bonusType?"\u0642\u0637\u0639":"%"):"",totalPrice:e.qty*e.item.price-(e.bonus&&"percentage"===e.bonusType?e.qty*e.item.price*e.bonus/100:0)}}));e=[].concat((0,l.Z)(e),[{itemName:"",companyName:"",warehouseName:"",formula:"",caliber:"",packing:"",price:"",customerPrice:"",quantity:"",bonus:"",totalPrice:G()}]),d().post("".concat(g.Hc,"/users/sendemail"),{cartItems:e},{timeout:25e3,headers:{Authorization:"Bearer ".concat(N)}}).then((function(){if(a((0,p.lc)({token:N})),Y(!1),M(!0),E){var e={pharmacy:q._id,warehouse:T.filter((function(e){return e.warehouse.warehouse.name===r}))[0].warehouse.warehouse._id,items:T.filter((function(e){return e.warehouse.warehouse.name===r})).map((function(e){return{item:e.item._id,qty:e.qty,bonus:e.bonus,bonusType:e.bonusType,price:e.item.price,customer_price:e.item.customer_price}}))};a((0,k.TR)({obj:e,token:N})),a((0,k.n9)(!0))}})).catch((function(e){Y(!1),F(!0)}))}else a((0,f.Rb)())},small:!0,children:n("confirm-save-order")})]})},q=n(3575),T=n(9942);var E=function(e){var r=e.onSelectedChange,n=(0,c.$)().t,l=(0,o.v9)(s.dy),m=(0,o.v9)(i.cj);return(0,t.useEffect)((function(){r()}),[]),l&&l.type===g.Wl.PHARMACY?(0,C.jsxs)("div",{className:T.Z.container,children:[(0,C.jsx)(u.Z,{children:(0,C.jsx)("h2",{children:n("cart")})}),m.length>0&&(0,C.jsx)(C.Fragment,{children:(0,C.jsx)("div",{children:m.map((function(e,r){return(0,C.jsx)(N,{warehouse:e},r)}))})}),0===m.length&&(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(q.Z,{msg:n("empty-cart")})})]}):(0,C.jsx)(a.l_,{to:"/signin"})}}}]);
//# sourceMappingURL=990.dac6977e.chunk.js.map